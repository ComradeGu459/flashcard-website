import React from "react";

export default function FlashcardLayout({ children }) {
  return (
    <div className="min-h-screen bg-gradient-to-br from-[#e0e7ff] via-[#f0f9ff] to-[#f3f4f6] flex flex-col">
      <header className="h-16 flex items-center px-8 bg-white/70 shadow-md backdrop-blur-xl sticky top-0 z-30">
        <span className="font-extrabold text-2xl text-[#6366f1] tracking-widest select-none">FlashBrain</span>
        <div className="ml-8 flex-1">
          <input
            placeholder="搜索知识点、标签、笔记..."
            className="w-[320px] py-2 px-5 rounded-2xl border-none bg-[#eef2ff] text-gray-700 font-semibold shadow-sm focus:outline-none focus:ring-2 focus:ring-indigo-300"
          />
        </div>
        <div className="ml-auto flex items-center gap-4">
          <button className="rounded-full bg-gradient-to-tr from-blue-400 to-indigo-400 text-white px-4 py-2 shadow-lg font-bold hover:scale-105 transition">导入题库</button>
          <button className="rounded-full bg-[#fef3c7] text-[#a16207] font-bold px-4 py-2 hover:bg-[#fde68a] transition">新建卡片</button>
        </div>
      </header>
      <main className="flex-1 flex max-w-7xl w-full mx-auto px-8 pt-8 gap-8">
        {/* 左侧导航 */}
        <aside className="w-64 flex-shrink-0">
          <div className="rounded-3xl bg-white/80 shadow-xl backdrop-blur-xl p-5 sticky top-24">
            <div className="font-bold text-lg mb-4 text-[#6366f1]">知识导航</div>
            <div className="space-y-2">
              <NavSection title="公共管理" chapters={["第一章", "第二章", "第三章"]} />
              <NavSection title="社会研究方法" chapters={["第一章", "第二章", "第三章"]} />
            </div>
          </div>
        </aside>
        {/* 中间知识卡片瀑布流 */}
        <section className="flex-1 grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-7">
          {children}
        </section>
        {/* 右侧统计面板 */}
        <aside className="w-80 flex-shrink-0">
          <div className="rounded-3xl bg-white/80 shadow-xl backdrop-blur-xl p-7 sticky top-24">
            <div className="flex items-center mb-4">
              <div className="font-bold text-[#6366f1] text-lg">距离考研还有</div>
              <span className="ml-2 rounded-2xl px-4 py-1 bg-gradient-to-tr from-blue-200 to-purple-200 text-[#4f46e5] font-semibold">123 天</span>
            </div>
            <ProgressCircle percent={17} />
            <div className="grid grid-cols-2 gap-3 text-center mt-8">
              <StatBlock label="已掌握" value="32" />
              <StatBlock label="复习中" value="11" />
              <StatBlock label="未学习" value="86" />
              <StatBlock label="高频考点" value="9" highlight />
            </div>
            <div className="mt-7 border-t pt-5">
              <div className="font-semibold mb-1 text-gray-500">学习记录</div>
              <div className="flex justify-between text-sm text-gray-500">
                <span>连续学习</span>
                <span className="text-[#6366f1] font-bold">5 天</span>
              </div>
              <div className="flex justify-between text-sm text-gray-500">
                <span>今日已学</span>
                <span className="text-[#6366f1] font-bold">12 张</span>
              </div>
            </div>
          </div>
          <div className="rounded-3xl bg-gradient-to-tr from-white/90 to-blue-50 shadow-xl mt-7 p-7">
            <div className="font-semibold mb-2 text-[#6366f1]">学习笔记</div>
            <div className="flex gap-2 mb-3">
              <button className="px-4 py-1 rounded-xl bg-[#f1f5f9] text-[#6366f1] font-semibold hover:bg-indigo-50">快速笔记</button>
              <button className="px-4 py-1 rounded-xl bg-[#f1f5f9] text-[#6366f1] font-semibold hover:bg-indigo-50">系统笔记</button>
            </div>
            <textarea className="w-full h-20 rounded-2xl border-none bg-[#eef2ff] p-3 resize-none shadow-inner" placeholder="记录临时想法或笔记..." />
          </div>
        </aside>
      </main>
    </div>
  );
}

// 侧边栏章节导航
function NavSection({ title, chapters }) {
  return (
    <div>
      <div className="font-bold text-[#2563eb]">{title}</div>
      <ul className="pl-3 mt-1 space-y-1">
        {chapters.map((ch, idx) => (
          <li key={idx} className="text-gray-700 hover:bg-indigo-50 rounded-xl px-2 py-1 cursor-pointer">{ch}</li>
        ))}
      </ul>
    </div>
  );
}

// 右侧圆环进度条
function ProgressCircle({ percent }) {
  return (
    <div className="flex justify-center items-center my-4">
      <svg width="92" height="92" viewBox="0 0 92 92">
        <circle cx="46" cy="46" r="41" fill="none" stroke="#e0e7ff" strokeWidth="9" />
        <circle
          cx="46" cy="46" r="41"
          fill="none"
          stroke="url(#grad)"
          strokeWidth="9"
          strokeDasharray={2 * Math.PI * 41}
          strokeDashoffset={(1 - percent / 100) * 2 * Math.PI * 41}
          strokeLinecap="round"
          transform="rotate(-90 46 46)"
        />
        <defs>
          <linearGradient id="grad" x1="0" y1="0" x2="92" y2="92">
            <stop stopColor="#6366f1" />
            <stop offset="1" stopColor="#38bdf8" />
          </linearGradient>
        </defs>
        <text x="50%" y="54%" textAnchor="middle" fill="#6366f1" fontSize="1.5rem" fontWeight="bold">{percent}%</text>
      </svg>
    </div>
  );
}

// 右侧统计小方块
function StatBlock({ label, value, highlight }) {
  return (
    <div className={`rounded-xl px-3 py-2 ${highlight ? "bg-gradient-to-r from-yellow-100 to-yellow-50 text-[#f59e42] font-bold" : "bg-[#f1f5f9] text-gray-700"} shadow-sm`}>
      <div className="text-lg">{value}</div>
      <div className="text-xs">{label}</div>
    </div>
  );
}
// 单张卡片
function FlashCard({ title, content, tags = [], onClick }) {
  return (
    <div
      className="rounded-3xl bg-white/90 shadow-xl p-7 transition-all duration-300 hover:-translate-y-2 hover:shadow-2xl group relative cursor-pointer"
      style={{ minHeight: "190px" }}
      onClick={onClick}
    >
      <div className="font-bold text-lg mb-3 text-gray-900">{title}</div>
      <div className="text-gray-600 leading-relaxed mb-3 line-clamp-4 group-hover:line-clamp-none transition-all">{content}</div>
      <div className="flex gap-2 mt-2 flex-wrap">
        {tags.map((t, idx) => (
          <span key={idx}
            className={`px-3 py-1 rounded-full text-xs font-bold
              ${t === "高频" ? "bg-gradient-to-r from-yellow-200 to-orange-100 text-yellow-900" :
              t === "重点" ? "bg-gradient-to-r from-blue-200 to-indigo-100 text-blue-900" :
              "bg-gray-100 text-gray-500"}
            `}
          >{t}</span>
        ))}
      </div>
      <div className="absolute top-4 right-6">
        <span className="inline-block bg-gradient-to-tr from-indigo-300 to-blue-200 text-[#6366f1] rounded-full px-2 py-0.5 text-xs font-semibold shadow">{Math.floor(Math.random()*100)}热度</span>
      </div>
    </div>
  );
}
